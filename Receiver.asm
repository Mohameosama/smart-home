org 00H

LED EQU P2.0
FAN EQU P0.0
BUZ EQU P2.2
AP4 EQU P2.3
AP5 EQU P2.4
AP6 EQU P2.5
AP7 EQU P2.6
AP8 EQU P2.7


; Serial initialization
SERIAL_INIT:
	MOV TMOD, #20H	; or 00100000B => Mode 2 for Timer1 (8bit Auto Reload)
	MOV TH1, #0FDH	;Setting BaudRate of 9600 (-3). SMOD is 0 by default
	MOV SCON, #50H	;Serial Mode 1, REN Enabled or 01010000B
	SETB TR1
	
	
; PORT 2 INIT
MOV P2, #0H
	
RECIEVE:
	JNB RI, $
	MOV A, SBUF
	CLR RI
	MOV R5, A
	MOV P1, R5
	
	
; TURN OFF EVERYTHING
COMPARE0:
	MOV A, R5
	SUBB A, #'0'
	JNZ COMPARE1
	MOV P2, 0H
	SETB FAN
	LJMP RECIEVE

	
COMPARE1:
	MOV A, R5
	SUBB A, #'1'
	JNZ COMPARE2
	JB LED, LEDOFF
	SETB LED
	LJMP RECIEVE
LEDOFF:
	CLR LED
	LJMP RECIEVE
	
	
COMPARE2:
	MOV A, R5
	SUBB A, #'2'
	JNZ COMPARE3
	JB FAN, FANOFF
	SETB FAN
	LJMP RECIEVE
FANOFF:
	CLR FAN
	LJMP RECIEVE
	
	
	
COMPARE3:
	MOV A, R5
	SUBB A, #'3'
	JNZ COMPARE4
	JB BUZ, BUZZOFF
	SETB BUZ
	LJMP RECIEVE
BUZZOFF:
	CLR BUZ
	LJMP RECIEVE
	
	
	
COMPARE4:
	MOV A, R5
	SUBB A, #'4'
	JNZ COMPARE5
	JB AP4, AP4OFF
	SETB AP4
	LJMP RECIEVE
AP4OFF:
	CLR AP4
	LJMP RECIEVE
	
	
	
COMPARE5:
	MOV A, R5
	SUBB A, #'5'
	JNZ COMPARE6
	JB AP5, AP5OFF
	SETB AP5
	LJMP RECIEVE
AP5OFF:
	CLR AP5
	LJMP RECIEVE
	
	
	
COMPARE6:
	MOV A, R5
	SUBB A, #'6'
	JNZ COMPARE7
	JB AP6, AP6OFF
	SETB AP6
	LJMP RECIEVE
AP6OFF:
	CLR AP6
	LJMP RECIEVE
	
	
	
COMPARE7:
	MOV A, R5
	SUBB A, #'7'
	JNZ COMPARE8
	JB AP7, AP7OFF
	SETB AP7
	LJMP RECIEVE
AP7OFF:
	CLR AP7
	LJMP RECIEVE
	
	
	
COMPARE8:
	MOV A, R5
	SUBB A, #'8'
	JNZ HLT
	JB AP8, AP8OFF
	SETB AP8
	LJMP RECIEVE
AP8OFF:
	CLR AP8
	LJMP RECIEVE
	

	
HLT:
	LJMP RECIEVE

END